<!DOCTYPE html>
<html>
<head>
	<title>Meyda</title>
	<script type="text/javascript" src="main.js"></script>
	<meta charset="UTF-8">
</head>
<body>
	<div class="container">
		<audio src="test.mp3" id="tune" controls></audio>
	</div>
	<script>
		var tune = document.getElementById('tune');
		tune.oncanplaythrough = function (e) {
			console.log("audio loaded");
			init();
			tune.play();
		}

		// callback for mic position
		function init() {
			// polyfill
			window.AudioContext = window.AudioContext || window.webkitAudioContext;
			var context = new AudioContext();
			// instantiate new medya

			// create audionode from mic
			window.source = context.createMediaElementSource( tune );

			var m = new Meyda(context,source,function(d){
				// update view in callback
				// ractive.set({rms:d});
				// console.log("output:", d);
			},"spectrum",256);
			document.body.onkeydown = function(){
				m.getSpectrum();
			}

			

			// connect mic to medya
			// m.connect(context.destination);
		}
	</script>
</body>
</html>
